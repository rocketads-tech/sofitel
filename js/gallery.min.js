(()=>{"use strict";const e=document.getElementById("imagePopup"),t=document.getElementById("popupImage"),n=document.querySelector(".close-btn"),o=document.querySelector(".prev-btn"),i=document.querySelector(".next-btn"),s=document.querySelectorAll("#gallery img");let l=0,c=0,r=0,d=!1,u=!1;function a(){e.style.display="none",document.body.style.overflow=""}function y(e){if(d)return;d=!0;let n="";1===e||"swipe-left"===e?n="slide-right":-1!==e&&"swipe-right"!==e||(n="slide-left"),t.classList.add(n),setTimeout((()=>{t.classList.remove(n),t.src=s[l].src,d=!1}),300)}function m(e="button"){l=(l+1)%s.length,t.src=s[l].src,y("swipe"===e?"swipe-left":1)}function p(e="button"){l=(l-1+s.length)%s.length,t.src=s[l].src,y("swipe"===e?"swipe-right":-1)}s.forEach(((n,o)=>{n.addEventListener("click",(()=>function(n){l=n,t.src=s[l].src,e.style.display="flex",document.body.style.overflow="hidden"}(o)))})),n.addEventListener("click",a),e.addEventListener("click",(t=>{t.target===e&&a()})),i.addEventListener("click",(()=>m("button"))),o.addEventListener("click",(()=>p("button"))),document.addEventListener("keydown",(t=>{"flex"!==e.style.display||u||(u=!0,"ArrowRight"===t.key&&m("button"),"ArrowLeft"===t.key&&p("button"),"Escape"===t.key&&a(),setTimeout((()=>{u=!1}),500))})),e.addEventListener("touchstart",(e=>{c=e.touches[0].clientX})),e.addEventListener("touchmove",(e=>{e.preventDefault(),r=e.touches[0].clientX}),{passive:!1}),e.addEventListener("touchend",(()=>{const e=c-r;e>50?m("swipe-left"):e<-50&&p("swipe-right")}));let f=null;function h(){window.innerWidth>768?f||(f=document.createElement("script"),f.src="./js/masonry.min.js?v="+Date.now(),f.onload=()=>{console.log("masonry.min.js загружен"),"function"==typeof initMasonry&&initMasonry()},document.body.appendChild(f)):f&&(document.querySelectorAll(".gallery img").forEach((e=>{e.style.width=""})),document.querySelectorAll(".gallery picture").forEach((e=>{e.style.width=""})),document.body.removeChild(f),f=null)}window.addEventListener("load",h),window.addEventListener("resize",h)})();